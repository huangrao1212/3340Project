library(readr)
datasetfull <- read_csv("/Users/richard/Documents/study/20fall/3340/project/insurance.csv")
library(readr)
datasetfull <- read_csv("insurance.csv")
View(insurance)
library(readr)
datasetfull <- read_csv("insurance.csv")
keep<-c('age','bmi','children','charges')
num_data<-subset(datasetfull, select=keep)
cor(num_data)
pairs(~age+bmi+children+charges,data=datasetfull)
install.packages("tidyverse")
install.packages("tidyverse")
install.packages("tidyverse")
library(tidyverse)
ggplot(data = datasetfull, aes(x = children, y = charges)) + geom_point()
install.packages("tidyverse")
library(ggplot2)
ggplot(data = datasetfull, aes(x = sex, y = charges)) + geom_point()
ggplot(data = datasetfull, aes(x = children, y = charges)) + geom_point()
ggplot(data = datasetfull, aes(x = smoker, y = charges)) + geom_point()
ggplot(data = datasetfull, aes(x = region, y = charges)) + geom_point()
datasetfull[nrow(datasetfull) + 1,] <- list(22,"female",23.71,0,"no","northeast",5503.7768)
unique(datasetfull$region)
datasetfull$sex<-as.factor(datasetfull$sex)
datasetfull$region<-as.factor(datasetfull$region)
datasetfull$smoker<-as.factor(datasetfull$smoker)
datasetfull$sex_male <- ifelse(datasetfull$sex == "male", 1, 0)
datasetfull$sex_female <- ifelse(datasetfull$sex == "female", 1, 0)
datasetfull$region_southwest <- ifelse(datasetfull$region == "southwest", 1, 0)
datasetfull$region_southeast <- ifelse(datasetfull$region == "southeast", 1, 0)
datasetfull$region_northwest <- ifelse(datasetfull$region == "northwest", 1, 0)
datasetfull$region_northeast <- ifelse(datasetfull$region == "northeast", 1, 0)
datasetfull$smoker_yes <- ifelse(datasetfull$smoker == "yes", 1, 0)
datasetfull$smoker_no <- ifelse(datasetfull$smoker == "no", 1, 0)
datasetfull <- subset(datasetfull, select = -c(sex, region, smoker))
nullmodel<-lm(charges~1,data=datasetfull)
fullmodel=lm(charges~sex_male+sex_female+region_southwest+region_southeast+region_northwest+region_northeast+age+bmi+children+smoker_yes+smoker_no,data=datasetfull)
step1=step(nullmodel,scope=list(lower=nullmodel, upper=fullmodel), direction="forward")
summary(step1)
nullmodel<-lm(charges~1,data=datasetfull)
fullmodel=lm(charges~sex_male+sex_female+region_southwest+region_southeast+region_northwest+region_northeast+age+bmi+children+smoker_yes+smoker_no,data=datasetfull)
step1=step(fullmodel, direction="backward")
summary(step1)
nullmodel<-lm(charges~1,data=datasetfull)
fullmodel=lm(charges~sex_male+sex_female+region_southwest+region_southeast+region_northwest+region_northeast+age+bmi+children+smoker_yes+smoker_no,data=datasetfull)
step1=step(fullmodel,scope=list(lower=nullmodel, upper=fullmodel), direction="forward")
summary(step1)
fullmodel2=lm(charges~region_southwest+region_southeast+region_northwest+region_northeast+age+bmi+children+sex_male*smoker_yes+sex_female*smoker_no+sex_male*smoker_no+sex_male*smoker_yes,data=datasetfull)
step2=step(fullmodel2,direction="backward")
summary(step2)
anova(step1,step2)
nullmodel<-lm(charges~1,data=datasetfull)
fullmodel=lm(charges~sex_male+sex_female+region_southwest+region_southeast+region_northwest+region_northeast+age+bmi+children+smoker_yes+smoker_no,data=datasetfull)
step1=step(fullmodel,scope=list(lower=nullmodel, upper=fullmodel), direction="forward")
summary(step1)
library(readr)
datasetfull <- read_csv("insurance.csv")
keep<-c('age','bmi','children','charges')
num_data<-subset(datasetfull, select=keep)
cor(num_data)
pairs(~age+bmi+children+charges,data=datasetfull)
datasetfull[nrow(datasetfull) + 1,] <- list(22,"female",23.71,0,"no","northeast",5503.7768)
unique(datasetfull$region)
datasetfull$sex<-as.factor(datasetfull$sex)
datasetfull$region<-as.factor(datasetfull$region)
datasetfull$smoker<-as.factor(datasetfull$smoker)
datasetfull$sex_male <- ifelse(datasetfull$sex == "male", 1, 0)
datasetfull$sex_female <- ifelse(datasetfull$sex == "female", 1, 0)
datasetfull$region_southwest <- ifelse(datasetfull$region == "southwest", 1, 0)
datasetfull$region_southeast <- ifelse(datasetfull$region == "southeast", 1, 0)
datasetfull$region_northwest <- ifelse(datasetfull$region == "northwest", 1, 0)
datasetfull$region_northeast <- ifelse(datasetfull$region == "northeast", 1, 0)
datasetfull$smoker_yes <- ifelse(datasetfull$smoker == "yes", 1, 0)
datasetfull$smoker_no <- ifelse(datasetfull$smoker == "no", 1, 0)
datasetfull <- subset(datasetfull, select = -c(sex, region, smoker))
nullmodel<-lm(charges~1,data=datasetfull)
fullmodel=lm(charges~sex_male+sex_female+region_southwest+region_southeast+region_northwest+region_northeast+age+bmi+children+smoker_yes+smoker_no,data=datasetfull)
step1=step(fullmodel,scope=list(lower=nullmodel, upper=fullmodel), direction="forward")
summary(step1)
View(nullmodel)
nullmodel<-lm(charges~1,data=datasetfull)
fullmodel=lm(charges~sex_male+sex_female+region_southwest+region_southeast+region_northwest+region_northeast+age+bmi+children+smoker_yes+smoker_no,data=datasetfull)
step1=step(fullmodel,direction="backward")
summary(step1)
View(datasetfull)
nullmodel<-lm(charges~1,data=datasetfull)
fullmodel=lm(charges~sex_male+sex_female+region_southwest+region_southeast+region_northwest+region_northeast+age+bmi+children+smoker_yes+smoker_no,data=datasetfull)
step1=step(fullmodel,scope=list(lower=nullmodel, upper=fullmodel), direction="forward")
summary(step1)
nullmodel<-lm(charges~1,data=datasetfull)
fullmodel=lm(charges~sex_male+sex_female+region_southwest+region_southeast+region_northwest+region_northeast+age+bmi+children+smoker_yes+smoker_no,data=datasetfull)
step1=step(nullmodel,scope=list(lower=nullmodel, upper=fullmodel), direction="forward")
summary(step1)
nullmodel<-lm(charges~1,data=datasetfull)
fullmodel=lm(charges~sex_male+sex_female+region_southwest+region_southeast+region_northwest+region_northeast+age+bmi+children+smoker_yes+smoker_no,data=datasetfull)
step1=step(fullmodel, direction="backward")
summary(step1)
fullmodel2=lm(charges~region_southwest+region_southeast+region_northwest+region_northeast+age+bmi+children+sex_male*smoker_yes+sex_female*smoker_no+sex_male*smoker_no+sex_male*smoker_yes,data=datasetfull)
step2=step(fullmodel2,direction="backward")
summary(step2)
anova(step1,step2)
install.packages("tidyverse")
library(ggplot2)
ggplot(data = datasetfull, aes(x = sex, y = charges)) + geom_boxplot()
library(readr)
datasetfull <- read_csv("insurance.csv")
keep<-c('age','bmi','children','charges')
num_data<-subset(datasetfull, select=keep)
cor(num_data)
pairs(~age+bmi+children+charges,data=datasetfull)
install.packages("tidyverse")
library(ggplot2)
ggplot(data = datasetfull, aes(x = sex, y = charges)) + geom_boxplot()
ggplot(data = datasetfull, aes(x = children, y = charges)) + geom_boxplot()
ggplot(data = datasetfull, aes(x = children, y = charges)) + geom_point()
ggplot(data = datasetfull, aes(x = children, y = charges)) + geom_boxplot()
ggplot(data = datasetfull, aes(x = as.factor(children), y = charges)) + geom_boxplot()
ggplot(data = datasetfull, aes(x = smoker, y = charges)) + geom_boxplot()
ggplot(data = datasetfull, aes(x = region, y = charges)) + geom_boxplot()
full.m <- lm(charges ~ ., data = datasetfull)
full.m <- lm(charges ~ ., data = datasetfull)
summary(full.m)
View(datasetfull)
unique(datasetfull$region)
datasetfull[nrow(datasetfull) + 1,] <- list(22,"female",23.71,0,"no","northeast",5503.7768)
unique(datasetfull$region)
datasetfull$sex<-as.factor(datasetfull$sex)
datasetfull$region<-as.factor(datasetfull$region)
datasetfull$smoker<-as.factor(datasetfull$smoker)
datasetfull$sex_male <- ifelse(datasetfull$sex == "male", 1, 0)
datasetfull$sex_female <- ifelse(datasetfull$sex == "female", 1, 0)
datasetfull$region_southwest <- ifelse(datasetfull$region == "southwest", 1, 0)
datasetfull$region_southeast <- ifelse(datasetfull$region == "southeast", 1, 0)
datasetfull$region_northwest <- ifelse(datasetfull$region == "northwest", 1, 0)
datasetfull$region_northeast <- ifelse(datasetfull$region == "northeast", 1, 0)
datasetfull$smoker_yes <- ifelse(datasetfull$smoker == "yes", 1, 0)
datasetfull$smoker_no <- ifelse(datasetfull$smoker == "no", 1, 0)
datasetfull <- subset(datasetfull, select = -c(sex, region, smoker))
nullmodel<-lm(charges~1,data=datasetfull)
fullmodel=lm(charges~sex_male+sex_female+region_southwest+region_southeast+region_northwest+region_northeast+age+bmi+children+smoker_yes+smoker_no,data=datasetfull)
step1=step(fullmodel, direction="backward")
summary(step1)
full.m <- lm(charges ~ ., data = datasetfull)
summary(full.m)
summary(full.m)
final.mdl <- stepAIC(full.m, direction = "backward")
summary(full.m)
final.mdl <- step(full.m, direction = "backward")
