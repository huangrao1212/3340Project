library(readr)
datasetfull <- read_csv("/Users/richard/Documents/study/20fall/3340/project/insurance.csv")
library(readr)
datasetfull <- read_csv("insurance.csv")
View(insurance)
library(readr)
datasetfull <- read_csv("insurance.csv")
keep<-c('age','bmi','children','charges')
num_data<-subset(datasetfull, select=keep)
cor(num_data)
pairs(~age+bmi+children+charges,data=datasetfull)
install.packages("tidyverse")
install.packages("tidyverse")
install.packages("tidyverse")
library(tidyverse)
ggplot(data = datasetfull, aes(x = children, y = charges)) + geom_point()
install.packages("tidyverse")
library(ggplot2)
ggplot(data = datasetfull, aes(x = sex, y = charges)) + geom_point()
ggplot(data = datasetfull, aes(x = children, y = charges)) + geom_point()
ggplot(data = datasetfull, aes(x = smoker, y = charges)) + geom_point()
ggplot(data = datasetfull, aes(x = region, y = charges)) + geom_point()
datasetfull[nrow(datasetfull) + 1,] <- list(22,"female",23.71,0,"no","northeast",5503.7768)
unique(datasetfull$region)
datasetfull$sex<-as.factor(datasetfull$sex)
datasetfull$region<-as.factor(datasetfull$region)
datasetfull$smoker<-as.factor(datasetfull$smoker)
datasetfull$sex_male <- ifelse(datasetfull$sex == "male", 1, 0)
datasetfull$sex_female <- ifelse(datasetfull$sex == "female", 1, 0)
datasetfull$region_southwest <- ifelse(datasetfull$region == "southwest", 1, 0)
datasetfull$region_southeast <- ifelse(datasetfull$region == "southeast", 1, 0)
datasetfull$region_northwest <- ifelse(datasetfull$region == "northwest", 1, 0)
datasetfull$region_northeast <- ifelse(datasetfull$region == "northeast", 1, 0)
datasetfull$smoker_yes <- ifelse(datasetfull$smoker == "yes", 1, 0)
datasetfull$smoker_no <- ifelse(datasetfull$smoker == "no", 1, 0)
datasetfull <- subset(datasetfull, select = -c(sex, region, smoker))
nullmodel<-lm(charges~1,data=datasetfull)
fullmodel=lm(charges~sex_male+sex_female+region_southwest+region_southeast+region_northwest+region_northeast+age+bmi+children+smoker_yes+smoker_no,data=datasetfull)
step1=step(nullmodel,scope=list(lower=nullmodel, upper=fullmodel), direction="forward")
summary(step1)
nullmodel<-lm(charges~1,data=datasetfull)
fullmodel=lm(charges~sex_male+sex_female+region_southwest+region_southeast+region_northwest+region_northeast+age+bmi+children+smoker_yes+smoker_no,data=datasetfull)
step1=step(fullmodel, direction="backward")
summary(step1)
nullmodel<-lm(charges~1,data=datasetfull)
fullmodel=lm(charges~sex_male+sex_female+region_southwest+region_southeast+region_northwest+region_northeast+age+bmi+children+smoker_yes+smoker_no,data=datasetfull)
step1=step(fullmodel,scope=list(lower=nullmodel, upper=fullmodel), direction="forward")
summary(step1)
fullmodel2=lm(charges~region_southwest+region_southeast+region_northwest+region_northeast+age+bmi+children+sex_male*smoker_yes+sex_female*smoker_no+sex_male*smoker_no+sex_male*smoker_yes,data=datasetfull)
step2=step(fullmodel2,direction="backward")
summary(step2)
anova(step1,step2)
nullmodel<-lm(charges~1,data=datasetfull)
fullmodel=lm(charges~sex_male+sex_female+region_southwest+region_southeast+region_northwest+region_northeast+age+bmi+children+smoker_yes+smoker_no,data=datasetfull)
step1=step(fullmodel,scope=list(lower=nullmodel, upper=fullmodel), direction="forward")
summary(step1)
library(readr)
datasetfull <- read_csv("insurance.csv")
keep<-c('age','bmi','children','charges')
num_data<-subset(datasetfull, select=keep)
cor(num_data)
pairs(~age+bmi+children+charges,data=datasetfull)
datasetfull[nrow(datasetfull) + 1,] <- list(22,"female",23.71,0,"no","northeast",5503.7768)
unique(datasetfull$region)
datasetfull$sex<-as.factor(datasetfull$sex)
datasetfull$region<-as.factor(datasetfull$region)
datasetfull$smoker<-as.factor(datasetfull$smoker)
datasetfull$sex_male <- ifelse(datasetfull$sex == "male", 1, 0)
datasetfull$sex_female <- ifelse(datasetfull$sex == "female", 1, 0)
datasetfull$region_southwest <- ifelse(datasetfull$region == "southwest", 1, 0)
datasetfull$region_southeast <- ifelse(datasetfull$region == "southeast", 1, 0)
datasetfull$region_northwest <- ifelse(datasetfull$region == "northwest", 1, 0)
datasetfull$region_northeast <- ifelse(datasetfull$region == "northeast", 1, 0)
datasetfull$smoker_yes <- ifelse(datasetfull$smoker == "yes", 1, 0)
datasetfull$smoker_no <- ifelse(datasetfull$smoker == "no", 1, 0)
datasetfull <- subset(datasetfull, select = -c(sex, region, smoker))
nullmodel<-lm(charges~1,data=datasetfull)
fullmodel=lm(charges~sex_male+sex_female+region_southwest+region_southeast+region_northwest+region_northeast+age+bmi+children+smoker_yes+smoker_no,data=datasetfull)
step1=step(fullmodel,scope=list(lower=nullmodel, upper=fullmodel), direction="forward")
summary(step1)
View(nullmodel)
nullmodel<-lm(charges~1,data=datasetfull)
fullmodel=lm(charges~sex_male+sex_female+region_southwest+region_southeast+region_northwest+region_northeast+age+bmi+children+smoker_yes+smoker_no,data=datasetfull)
step1=step(fullmodel,direction="backward")
summary(step1)
View(datasetfull)
nullmodel<-lm(charges~1,data=datasetfull)
fullmodel=lm(charges~sex_male+sex_female+region_southwest+region_southeast+region_northwest+region_northeast+age+bmi+children+smoker_yes+smoker_no,data=datasetfull)
step1=step(fullmodel,scope=list(lower=nullmodel, upper=fullmodel), direction="forward")
summary(step1)
nullmodel<-lm(charges~1,data=datasetfull)
fullmodel=lm(charges~sex_male+sex_female+region_southwest+region_southeast+region_northwest+region_northeast+age+bmi+children+smoker_yes+smoker_no,data=datasetfull)
step1=step(nullmodel,scope=list(lower=nullmodel, upper=fullmodel), direction="forward")
summary(step1)
nullmodel<-lm(charges~1,data=datasetfull)
fullmodel=lm(charges~sex_male+sex_female+region_southwest+region_southeast+region_northwest+region_northeast+age+bmi+children+smoker_yes+smoker_no,data=datasetfull)
step1=step(fullmodel, direction="backward")
summary(step1)
fullmodel2=lm(charges~region_southwest+region_southeast+region_northwest+region_northeast+age+bmi+children+sex_male*smoker_yes+sex_female*smoker_no+sex_male*smoker_no+sex_male*smoker_yes,data=datasetfull)
step2=step(fullmodel2,direction="backward")
summary(step2)
anova(step1,step2)
install.packages("tidyverse")
library(ggplot2)
ggplot(data = datasetfull, aes(x = sex, y = charges)) + geom_boxplot()
library(readr)
datasetfull <- read_csv("insurance.csv")
keep<-c('age','bmi','children','charges')
num_data<-subset(datasetfull, select=keep)
cor(num_data)
pairs(~age+bmi+children+charges,data=datasetfull)
install.packages("tidyverse")
library(ggplot2)
ggplot(data = datasetfull, aes(x = sex, y = charges)) + geom_boxplot()
ggplot(data = datasetfull, aes(x = children, y = charges)) + geom_boxplot()
ggplot(data = datasetfull, aes(x = children, y = charges)) + geom_point()
ggplot(data = datasetfull, aes(x = children, y = charges)) + geom_boxplot()
ggplot(data = datasetfull, aes(x = as.factor(children), y = charges)) + geom_boxplot()
ggplot(data = datasetfull, aes(x = smoker, y = charges)) + geom_boxplot()
ggplot(data = datasetfull, aes(x = region, y = charges)) + geom_boxplot()
full.m <- lm(charges ~ ., data = datasetfull)
full.m <- lm(charges ~ ., data = datasetfull)
summary(full.m)
View(datasetfull)
unique(datasetfull$region)
datasetfull[nrow(datasetfull) + 1,] <- list(22,"female",23.71,0,"no","northeast",5503.7768)
unique(datasetfull$region)
datasetfull$sex<-as.factor(datasetfull$sex)
datasetfull$region<-as.factor(datasetfull$region)
datasetfull$smoker<-as.factor(datasetfull$smoker)
datasetfull$sex_male <- ifelse(datasetfull$sex == "male", 1, 0)
datasetfull$sex_female <- ifelse(datasetfull$sex == "female", 1, 0)
datasetfull$region_southwest <- ifelse(datasetfull$region == "southwest", 1, 0)
datasetfull$region_southeast <- ifelse(datasetfull$region == "southeast", 1, 0)
datasetfull$region_northwest <- ifelse(datasetfull$region == "northwest", 1, 0)
datasetfull$region_northeast <- ifelse(datasetfull$region == "northeast", 1, 0)
datasetfull$smoker_yes <- ifelse(datasetfull$smoker == "yes", 1, 0)
datasetfull$smoker_no <- ifelse(datasetfull$smoker == "no", 1, 0)
datasetfull <- subset(datasetfull, select = -c(sex, region, smoker))
nullmodel<-lm(charges~1,data=datasetfull)
fullmodel=lm(charges~sex_male+sex_female+region_southwest+region_southeast+region_northwest+region_northeast+age+bmi+children+smoker_yes+smoker_no,data=datasetfull)
step1=step(fullmodel, direction="backward")
summary(step1)
full.m <- lm(charges ~ ., data = datasetfull)
summary(full.m)
summary(full.m)
final.mdl <- stepAIC(full.m, direction = "backward")
summary(full.m)
final.mdl <- step(full.m, direction = "backward")
library(readr)
datasetfull <- read_csv("insurance.csv")
summary(datasetfull)
install.packages("ggplot2")
install.packages("olsrr")
library(readr)
datasetfull <- read_csv("insurance.csv")
ggplot(data = datasetfull, aes(x = sex, y = charges)) + geom_boxplot() + labs(title = "Charges distribution based on sex")
library(readr)
library(ggplot2)
datasetfull <- read_csv("insurance.csv")
keep<-c('age','bmi','children','charges')
num_data<-subset(datasetfull, select=keep)
cor(num_data)
pairs(~age+bmi+children+charges,data=datasetfull)
summary(datasetfull)
ggplot(data = datasetfull, aes(x = sex, y = charges)) + geom_boxplot() + labs(title = "Charges distribution based on sex")
ggplot(data = datasetfull, aes(sex)) + geom_histogram(stat = "count", fill = c("orange", "blue")) + labs(title = "Sex distribution")
ggplot(data = datasetfull, aes(x = as.factor(children), y = charges)) + geom_boxplot() + labs(x = "Number of Children") + labs(title = "Charges distribution based on Number of Children")
ggplot(data = datasetfull, aes(x = smoker, y = charges)) + geom_boxplot() + labs(title = "Charges distribution based on sex")
ggplot(data = datasetfull, aes(x = smoker, y = charges)) + geom_boxplot() + labs(title = "Charges distribution based on smoker")
ggplot(data = datasetfull, aes(x = region, y = charges)) + geom_boxplot() + labs(title = "Charges distribution based on sex")
ggplot(data = datasetfull, aes(x = region, y = charges)) + geom_boxplot() + labs(title = "Charges distribution based on region")
bmi_category <- cut(datasetfull$bmi, c(0, 18.5, 24.9, 29.9, 10000), labels = c("Underweight","Healthy weight","Overweight","Obese"), right = FALSE)
bmi_category <- data.frame((bmi_category))
bmidata <- cbind(charge = datasetfull$charges, bmi = bmi_category)
colnames(bmidata) <- c("charge", "bmi")
ggplot(data = bmidata, aes(x = bmi, y = charge)) + geom_boxplot() + labs(title = "Charges distribution based on bmi class")
age_range <- data.frame(ifelse(datasetfull$age < 20, "Minor", "Adult"))
agedata <- cbind(datasetfull$charges, age_range)
colnames(agedata) <- c("charge", "age")
ggplot(data = agedata, aes(x = age, y = charge)) + geom_boxplot() + labs(title = "Charges distribution based on age")
ggplot(agedata, aes(x = age))+geom_histogram(stat="count", fill = c("orange", "blue")) + labs(title = "Age distribution")
ggplot(data = datasetfull, aes(sex)) + geom_histogram(stat = "count", fill = "white") + labs(title = "Sex distribution")
ggplot(data = datasetfull, aes(sex)) + geom_histogram(stat = "count", fill = "white", color = "black") + labs(title = "Sex distribution")
ggplot(data = datasetfull, aes(sex)) + geom_histogram(stat = "count", fill = "white", color = "grey") + labs(title = "Sex distribution")
ggplot(agedata, aes(x = age))+geom_histogram(stat="count", fill = "white", color = "grey") + labs(title = "Age distribution")
library(readr)
library(ggplot2)
datasetfull <- read_csv("insurance.csv")
# one new additional data point
datasetfull[nrow(datasetfull) + 1,] <- list(22,"female",23.71,0,"no","northeast",5503.7768)
keep<-c('age','bmi','children','charges')
num_data<-subset(datasetfull, select=keep)
cor(num_data)
pairs(~age+bmi+children+charges,data=datasetfull)
summary(datasetfull)
keep<-c('age','bmi','children','charges')
num_data<-subset(datasetfull, select=keep)
cor(num_data)
pairs(~age+bmi+children+charges,data=datasetfull)
ggplot(data = datasetfull, aes(x = sex, y = charges)) + geom_boxplot() + labs(title = "Charges distribution based on sex")
ggplot(data = datasetfull, aes(x = as.factor(children), y = charges)) + geom_boxplot() + labs(x = "Number of Children") + labs(title = "Charges distribution based on Number of Children")
ggplot(data = datasetfull, aes(x = smoker, y = charges)) + geom_boxplot() + labs(title = "Charges distribution based on smoker")
ggplot(data = datasetfull, aes(x = region, y = charges)) + geom_boxplot() + labs(title = "Charges distribution based on region")
View(datasetfull)
install.packages("dplyr")
install.packages("dplyr")
install.packages("dplyr")
library(readr)
library(ggplot2)
library(dplyr)
install.packages("dplyr")
install.packages("dplyr")
install.packages("dplyr")
install.packages("dplyr")
install.packages("dplyr")
library(readr)
library(ggplot2)
library(dplyr)
remove.packages("rlang")
install.packages("rlang")
library(rlang)
install.packages("rlang")
remove.packages("rlang")
install.packages("rlang")
library(rlang)
library(readr)
library(ggplot2)
library(dplyr)
update.packages("dplyr")
remove.packages("rlang")
install.packages("rlang")
library(rlang)
library(readr)
library(ggplot2)
library(dplyr)
install.packages("rlang")
library(dplyr)
remove.packages("tidyverse")
library(rlang)
library(readr)
library(ggplot2)
library(dplyr)
update.packages("dplyr")
install.packages("dplyr")
remove.packages("tidyverse")
library(rlang)
library(readr)
library(ggplot2)
library(dplyr)
Sys.setlocale("LC_ALL","Chinese")
remove.packages("tidyverse")
library(rlang)
library(readr)
library(ggplot2)
library(dplyr)
remove.packages("tidyverse")
library(rlang)
library(readr)
library(ggplot2)
library(dplyr)
remove.packages("tidyverse")
library(rlang)
library(readr)
library(ggplot2)
library(dplyr)
old.packages("dplyr")
install.packages("tidyverse")
library(rlang)
library(readr)
library(ggplot2)
library(dplyr)
library(rlang)
library(readr)
library(ggplot2)
library(dplyr)
install.packages("MPV")
install.packages("faraway")
library(MPV)
library(faraway)
vif(step2)
install.packages("MPV")
install.packages("faraway")
library(MPV)
library(faraway)
vif(step2)
install.packages("MPV")
install.packages("ggplot2")
install.packages("olsrr")
install.packages("dplyr")
library(rlang)
library(readr)
library(ggplot2)
library(dplyr)
datasetfull <- read_csv("insurance.csv")
# one new additional data point
datasetfull[nrow(datasetfull) + 1,] <- list(22,"female",23.71,0,"no","northeast",5503.7768)
count(datasetfull, sex)
count(datasetfull, region)
count(datasetfull, smoker)
keep<-c('age','bmi','children','charges')
num_data<-subset(datasetfull, select=keep)
cor(num_data)
pairs(~age+bmi+children+charges,data=datasetfull)
summary(datasetfull)
ggplot(data = datasetfull, aes(x = sex, y = charges)) + geom_boxplot() + labs(title = "Charges distribution based on sex")
ggplot(data = datasetfull, aes(sex)) + geom_histogram(stat = "count", fill = "white", color = "grey") + labs(title = "Sex distribution")
ggplot(data = datasetfull, aes(x = as.factor(children), y = charges)) + geom_boxplot() + labs(x = "Number of Children") + labs(title = "Charges distribution based on Number of Children")
ggplot(data = datasetfull, aes(x = smoker, y = charges)) + geom_boxplot() + labs(title = "Charges distribution based on smoker")
ggplot(data = datasetfull, aes(x = region, y = charges)) + geom_boxplot() + labs(title = "Charges distribution based on region")
bmi_category <- cut(datasetfull$bmi, c(0, 18.5, 24.9, 29.9, 10000), labels = c("Underweight","Healthy weight","Overweight","Obese"), right = FALSE)
bmi_category <- data.frame((bmi_category))
bmidata <- cbind(charge = datasetfull$charges, bmi = bmi_category)
colnames(bmidata) <- c("charge", "bmi")
ggplot(data = bmidata, aes(x = bmi, y = charge)) + geom_boxplot() + labs(title = "Charges distribution based on bmi class")
age_range <- data.frame(ifelse(datasetfull$age < 20, "Minor", "Adult"))
agedata <- cbind(datasetfull$charges, age_range)
colnames(agedata) <- c("charge", "age")
ggplot(data = agedata, aes(x = age, y = charge)) + geom_boxplot() + labs(title = "Charges distribution based on age")
ggplot(agedata, aes(x = age))+geom_histogram(stat="count", fill = "white", color = "grey") + labs(title = "Age distribution")
unique(datasetfull$region)
datasetfull$sex<-as.factor(datasetfull$sex)
datasetfull$region<-as.factor(datasetfull$region)
datasetfull$smoker<-as.factor(datasetfull$smoker)
datasetfull$sex_male <- ifelse(datasetfull$sex == "male", 1, 0)
datasetfull$sex_female <- ifelse(datasetfull$sex == "female", 1, 0)
datasetfull$region_southwest <- ifelse(datasetfull$region == "southwest", 1, 0)
datasetfull$region_southeast <- ifelse(datasetfull$region == "southeast", 1, 0)
datasetfull$region_northwest <- ifelse(datasetfull$region == "northwest", 1, 0)
datasetfull$region_northeast <- ifelse(datasetfull$region == "northeast", 1, 0)
datasetfull$smoker_yes <- ifelse(datasetfull$smoker == "yes", 1, 0)
datasetfull$smoker_no <- ifelse(datasetfull$smoker == "no", 1, 0)
datasetfull <- subset(datasetfull, select = -c(sex, region, smoker))
fullmodel1=lm(charges~region_southwest+region_southeast+region_northwest+region_northeast+age+bmi+children+sex_male+smoker_yes+sex_female+smoker_no,data=datasetfull)
step1=step(fullmodel1,direction="backward")
summary(step1)
fullmodel2=lm(charges~region_southwest+region_southeast+region_northwest+region_northeast+age+bmi+children+bmi*smoker_yes+bmi*smoker_no,data=datasetfull)
step2=step(fullmodel2,direction="backward")
summary(step2)
anova(step1,step2)
hatvalue <- hat(datasetfull)
plot(step2)
# Residuals vs Fitted:
# Looking at the Residuals vs Fitted plot, we can see that the red line is approximately flat, which means that the mean of error is approximately equal to 0.
# Normal Q-Q:
# The residuals are approximately matched to the diagonal line, which means that the residuals are roughly normally distributed. And we can see that both the upper and lower tail are ‘heavier’ (have larger values) than what we would expect under the gauss-markov assumptions.
# Scale-Location:
# Looking at the Scale-Location plot, we can see that the red line is approximately flat, which means that there is no indication of having non-constant variance.
# Residuals vs Leverage:
# The Residuals vs Leverage plot indicate that there is no evidence of outliers because the “Cook’s distance” dashed curves don’t even appear on the plot. And there exists some leverage points: 1301, 578, 544.
install.packages("MPV")
install.packages("faraway")
library(MPV)
library(faraway)
vif(step2)
# As for the multicolinearity, since all the attributes' vif are less than 10, we can conclude that these variables are independent.
fullmodel2=lm(charges~region_southwest+region_southeast+region_northwest+region_northeast+age+bmi+children+bmi*smoker_yes+bmi*smoker_no,data=datasetfull)
step2=step(fullmodel2,direction="both")
summary(step2)
install.packages("ggplot2")
install.packages("olsrr")
install.packages("dplyr")
library(rlang)
library(readr)
library(ggplot2)
library(dplyr)
datasetfull <- read_csv("insurance.csv")
# one new additional data point
datasetfull[nrow(datasetfull) + 1,] <- list(22,"female",23.71,0,"no","northeast",5503.7768)
count(datasetfull, sex)
count(datasetfull, region)
count(datasetfull, smoker)
keep<-c('age','bmi','children','charges')
num_data<-subset(datasetfull, select=keep)
cor(num_data)
pairs(~age+bmi+children+charges,data=datasetfull)
summary(datasetfull)
ggplot(data = datasetfull, aes(x = sex, y = charges)) + geom_boxplot() + labs(title = "Charges distribution based on sex")
ggplot(data = datasetfull, aes(sex)) + geom_histogram(stat = "count", fill = "white", color = "grey") + labs(title = "Sex distribution")
ggplot(data = datasetfull, aes(x = as.factor(children), y = charges)) + geom_boxplot() + labs(x = "Number of Children") + labs(title = "Charges distribution based on Number of Children")
ggplot(data = datasetfull, aes(x = smoker, y = charges)) + geom_boxplot() + labs(title = "Charges distribution based on smoker")
ggplot(data = datasetfull, aes(x = region, y = charges)) + geom_boxplot() + labs(title = "Charges distribution based on region")
bmi_category <- cut(datasetfull$bmi, c(0, 18.5, 24.9, 29.9, 10000), labels = c("Underweight","Healthy weight","Overweight","Obese"), right = FALSE)
bmi_category <- data.frame((bmi_category))
bmidata <- cbind(charge = datasetfull$charges, bmi = bmi_category)
colnames(bmidata) <- c("charge", "bmi")
ggplot(data = bmidata, aes(x = bmi, y = charge)) + geom_boxplot() + labs(title = "Charges distribution based on bmi class")
age_range <- data.frame(ifelse(datasetfull$age < 20, "Minor", "Adult"))
agedata <- cbind(datasetfull$charges, age_range)
colnames(agedata) <- c("charge", "age")
ggplot(data = agedata, aes(x = age, y = charge)) + geom_boxplot() + labs(title = "Charges distribution based on age")
ggplot(agedata, aes(x = age))+geom_histogram(stat="count", fill = "white", color = "grey") + labs(title = "Age distribution")
unique(datasetfull$region)
datasetfull$sex<-as.factor(datasetfull$sex)
datasetfull$region<-as.factor(datasetfull$region)
datasetfull$smoker<-as.factor(datasetfull$smoker)
datasetfull$sex_male <- ifelse(datasetfull$sex == "male", 1, 0)
datasetfull$sex_female <- ifelse(datasetfull$sex == "female", 1, 0)
datasetfull$region_southwest <- ifelse(datasetfull$region == "southwest", 1, 0)
datasetfull$region_southeast <- ifelse(datasetfull$region == "southeast", 1, 0)
datasetfull$region_northwest <- ifelse(datasetfull$region == "northwest", 1, 0)
datasetfull$region_northeast <- ifelse(datasetfull$region == "northeast", 1, 0)
datasetfull$smoker_yes <- ifelse(datasetfull$smoker == "yes", 1, 0)
datasetfull$smoker_no <- ifelse(datasetfull$smoker == "no", 1, 0)
datasetfull <- subset(datasetfull, select = -c(sex, region, smoker))
fullmodel1=lm(charges~region_southwest+region_southeast+region_northwest+region_northeast+age+bmi+children+sex_male+smoker_yes+sex_female+smoker_no,data=datasetfull)
step1=step(fullmodel1,direction="backward")
summary(step1)
fullmodel2=lm(charges~region_southwest+region_southeast+region_northwest+region_northeast+age+bmi+children+sex_male*smoker_yes+sex_female*smoker_no+sex_male*smoker_no+sex_male*smoker_yes,data=datasetfull)
step2=step(fullmodel2,direction="backward")
summary(step2)
anova(step1,step2)
plot(step2)
# Residuals vs Fitted:
# Looking at the Residuals vs Fitted plot, we can see that the red line is approximately flat, which means that the mean of error is approximately equal to 0.
# Normal Q-Q:
# The residuals are approximately matched to the diagonal line, which means that the residuals are roughly normally distributed. And we can see that both the upper and lower tail are ‘heavier’ (have larger values) than what we would expect under the gauss-markov assumptions.
# Scale-Location:
# Looking at the Scale-Location plot, we can see that the red line is approximately flat, which means that there is no indication of having non-constant variance.
# Residuals vs Leverage:
# The Residuals vs Leverage plot indicate that there is no evidence of outliers because the “Cook’s distance” dashed curves don’t even appear on the plot. And there exists some leverage points: 1301, 578, 544.
install.packages("MPV")
install.packages("faraway")
library(MPV)
library(faraway)
vif(step2)
# As for the multicolinearity, since all the attributes' vif are less than 10, we can conclude that these variables are independent.
